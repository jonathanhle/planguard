name: Example - Using Planguard Action

on:
  workflow_dispatch:

jobs:
  # Example 1: Custom config with JSON output
  custom-config:
    name: Custom Config
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run Planguard with custom config
        uses: jonathanhle/planguard@v1
        with:
          config: examples/.planguard/config.hcl
          directory: examples/terraform
          format: json
          fail-on: warning
        continue-on-error: true  # Example files have violations

  # Example 2: SARIF output for GitHub Security
  sarif-security:
    name: SARIF for Security Tab
    runs-on: ubuntu-latest
    permissions:
      security-events: write
    steps:
      - uses: actions/checkout@v4

      - name: Run Planguard
        uses: jonathanhle/planguard@v1
        with:
          directory: examples/terraform
          format: sarif
        continue-on-error: true

      - name: Upload SARIF to GitHub Security
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: planguard-results.sarif
